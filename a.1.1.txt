Trie(file){
	// init root
	depth <- the number of attributes in the schema
	readData(file)  // read data file line by line and insert tuples into the trie
}

readData(file){
	for each line in the file{
		tuple <- parse each line as an array
		insert(tuple)
	}
}

insert(tuple){
	TrieNode current <- Trie.root
	for(attribute <- tuple){
		if(current.children does not contain attribute as its key){
			// add attribute as a new key in current.children
		}
		current <- current.children.get(attribute)
	}	
}


// parse SQL aggregates and store them in a list
evaluate1(){
	// init array with its size = Trie.depth
    traverse1(Trie.root, 0, array);
    // print out the computational results for each query
}

traverse1(root, level, array){
    if(reach the bottom of the trie){
        for(query <- querie_list){
            // perform calculation
        }
        return;
    }
    map <- root.children
    for(key : map.keySet){
        Trie.TrieNode next = map.get(key);
        if(next != null){
            array[level] = key;
            traverse1(next, level + 1, str);
        }
    }
}


//q1.1.3

// init aggs_gb_A & aggs_gb_B && aggs_gb_C && aggs

// init array

for (r_A <- R_TRIE){
	array[0] = r_A.A
	
	for(r_B <- r_A.LIST){
		array[1] = r_B.B
		
		for(r_C <- r_B.LIST){
			array[2] = r_C.C

			aggs_gb_A[array[0]][0] += 1
			aggs_gb_A[array[0]][1] += array[1]
			aggs_gb_A[array[0]][2] += array[2]

			aggs_gb_C[array[2]][0] += 1	
			aggs_gb_C[array[2]][1] += array[0]
			aggs_gb_C[array[2]][2] += array[1]	

			aggs_gb_C[array[2]][0] += 1
			aggs_gb_C[array[2]][1] += array[0]
			aggs_gb_C[array[2]][2] += array[1]

			aggs[0] += 1					
			aggs[1] += array[0]		
			aggs[2] += array[1]				
			aggs[3] += array[2]				
			aggs[4] += array[0] * array[1]		
			aggs[5] += array[0] * array[2]	
			aggs[6] += array[1] * array[2]					
			
		}
	}
}

independent:
do sum(A) for each tuple
do sum(1) for each tuple

for each tuple:
    sum(1)
    sum(A)



Testing results:

EXECUTING FILE: dataset/sf1.csv
Evaluate the query batch, run time: 442ms.
Evaluate the query independently, run time: 308ms.
EXECUTING FILE: dataset/sf2.csv
Evaluate the query batch, run time: 653ms.
Evaluate the query independently, run time: 716ms.
EXECUTING FILE: dataset/sf3.csv
Evaluate the query batch, run time: 977ms.
Evaluate the query independently, run time: 817ms.
EXECUTING FILE: dataset/sf4.csv
Evaluate the query batch, run time: 1215ms.
Evaluate the query independently, run time: 1139ms.
EXECUTING FILE: dataset/sf5.csv
Evaluate the query batch, run time: 1486ms.
Evaluate the query independently, run time: 1405ms.
EXECUTING FILE: dataset/sf6.csv
Evaluate the query batch, run time: 1920ms.
Evaluate the query independently, run time: 1666ms.
EXECUTING FILE: dataset/sf7.csv
Evaluate the query batch, run time: 2177ms.
Evaluate the query independently, run time: 1947ms.
EXECUTING FILE: dataset/sf8.csv
Evaluate the query batch, run time: 2308ms.
Evaluate the query independently, run time: 2195ms.
EXECUTING FILE: dataset/sf9.csv
Evaluate the query batch, run time: 2745ms.
Evaluate the query independently, run time: 2494ms.
EXECUTING FILE: dataset/sf10.csv
Evaluate the query batch, run time: 3074ms.
Evaluate the query independently, run time: 2824ms.
EXECUTING FILE: dataset/sf11.csv
Evaluate the query batch, run time: 3481ms.
Evaluate the query independently, run time: 3113ms.
EXECUTING FILE: dataset/sf12.csv
Evaluate the query batch, run time: 3943ms.
Evaluate the query independently, run time: 3491ms.
EXECUTING FILE: dataset/sf13.csv
Evaluate the query batch, run time: 4335ms.
Evaluate the query independently, run time: 3811ms.
EXECUTING FILE: dataset/sf14.csv
Evaluate the query batch, run time: 4713ms.
Evaluate the query independently, run time: 4156ms.
EXECUTING FILE: dataset/sf15.csv
Evaluate the query batch, run time: 4962ms.
Evaluate the query independently, run time: 4433ms.
EXECUTING FILE: dataset/sf16.csv
Evaluate the query batch, run time: 5405ms.
Evaluate the query independently, run time: 4677ms.
EXECUTING FILE: dataset/sf17.csv
Evaluate the query batch, run time: 5609ms.
Evaluate the query independently, run time: 5082ms.
EXECUTING FILE: dataset/sf18.csv
Evaluate the query batch, run time: 6025ms.
Evaluate the query independently, run time: 5363ms.
EXECUTING FILE: dataset/sf19.csv
Evaluate the query batch, run time: 6421ms.
Evaluate the query independently, run time: 5752ms.
EXECUTING FILE: dataset/sf20.csv
Evaluate the query batch, run time: 6922ms.
Evaluate the query independently, run time: 6176ms.